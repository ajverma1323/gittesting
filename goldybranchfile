latested code from 2nd branch
